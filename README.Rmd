---
output: github_document
---
<p align="center">
  <a href="https://github.com/frahik/GFR">
    <img src="Logo.png" alt="Genomic Functional Regression Logo"/>
  </a>
  <h4 align="center">
    **G**enomic **F**unctional **R**egression analysis in R - Development version 0.9 - rev 6 
  </h4>
  <h4 align="center">
    [Last README update: `r format(Sys.Date())`]
  </h4>
  <p align="center">
    [![Release][release-badge]][cran]
    [![License: LGPL v3][LGPL-badge]][LGPL]
    [![Project Status: Active][status-bagde]][status]
    [![Downloads][downloads-badge]][cran]
  </p>
</p>


----------

# Table of contents
  - [NEWS](#news)
  - [instructions](#instructions)
    - [Installation](#install)
    - [Demostration examples](#demo)
      - [Available data](#data)
      - [Fitting a model](#fit-model)
      - [Predictive model](#predictive-model)
      - [Example #1 of how generate automatically a linear predictor](#auto-ETA)
      - [Example #2 of how generate automatically a linear predictor](#auto-ETA2)
      - [Example of how generate manually a linear predictor](#HM-ETA)
  - [How to cite this package](#cite)
  - [Contributions](#contributions)
  - [Authors](#authors)

<h2 id="news">
  News of this version (0.9)
</h2>

* Rename from BGFRA -> BFR -> GFR
* Initial development is in progress, but there has not yet been a stable, usable release suitable for the public; this is a pre-release, be careful.

<h2 id="instructions">
  Instructions for proper implementation
</h2>


<h3 id="install">
  Installation
</h3>

To complete installation of dev version of GFR from GitHub, you have to install a few packages first.

```{r installation, eval = FALSE}
install.packages('devtools')
devtools::install_github('frahik/GFR')
```

<h3 id="demo">
  Demostration examples
</h3>

<h4 id="data">
  Available data
</h4>


```{r data}
rm(list = ls())
library(GFR)
data("Wheat_GFR")

data <- Wheat_GFR # Load from data Wheat_GFR
Bands <- Wheat_Bands # Load from data Wheat_GFR
Wavelengths <- Wheat_Wavelengths # Load from data Wheat_GFR

data("Maize_GFR")
data <- Maize_GFR # Load from data Maize_GFR
Bands <- Maize_Bands # Load from data Maize_GFR
Wavelengths <- Maize_Wavelengths # Load from data Maize_GFR
```

<h4 id="fit-model">
  Fitting a model
</h4>


```{r fit_model}
data("Wheat_GFR")
data <- Wheat_GFR[which(Wheat_GFR$Env == 'Drought'), ]

fm <- BFR(data, nIter = 1000, burnIn = 300, verbose = F)

plot(fm)
```

<h4 id="predictive-model">
  Predictive model with a K-Folds Cross-validation
</h4>

```{r predictive_model}
data("Wheat_GFR")
data <- Wheat_GFR[which(Wheat_GFR$Env == 'Drought'), ]
Crossvalidation_list <- list(Type = 'KFold', nFolds = 3)

pm <- BFR(data, nIter = 1000, burnIn = 300, set_seed = 10, CrossValidation = Crossvalidation_list, verbose = F)
summary(pm)

boxplot(pm)
```

<h4 id="auto-ETA">
  Generate automatically a linear predictor (Only Multi-Environment example)
</h4>


```{r auto_ETA}
library(GFR)
data("Wheat_GFR")
CrossV <- list(Type = 'KFold', nFolds = 3)
ETA2 <- ETAGenerate(Wheat_GFR, datasetID = 'Line', priorType = 'BayesB', Bands = Wheat_Bands,
                    Wavelengths = Wheat_Wavelengths, method = 'Alternative2', basisType = 'Bspline.Basis', nBasis = 21)


pm2 <- BFR(ETA = ETA2, data, nIter = 1000, burnIn = 300, set_seed = 10, CrossValidation = CrossV, verbose = F)
summary(pm2)

plot(pm2)
```

<h4 id="auto-ETA2">
  Generate automatically a linear predictor (Multi-Trait & Multi-Environment example)
</h4>

```{r auto_ETA2}
data("Maize_GFR")
CrossV <- list(Type = 'RandomPartition', NPartitions = 5, PTesting = .25)
ETA3 <- ETAGenerate(Maize_GFR, basisType = 'Bspline.Basis', Bands = Maize_Bands, Wavelengths = Maize_Wavelengths, priorType = 'BRR', method = 'Simple', nBasis = 21)
ETA3$Design
ETA3$Basis
ETA3$Prior
ETA3$Method
pm3 <- BFR(ETA = ETA3, data, nIter = 1000, burnIn = 300, set_seed = 10, CrossValidation = CrossV, verbose = F)
summary(pm3)
```


<h4 id="HM-ETA">
  Handmade linear predictor
</h4>

```{r HM_ETA}
CrossV <- list(Type = 'KFold', nFolds = 5)
ETA4 <- list(Env = list(X = model.matrix(~0+as.factor(Wheat_GFR$Env)), model = 'FIXED'),
             Line = list(X = model.matrix(~0+as.factor(Wheat_GFR$Line)), model = 'BRR'),
             Bands = list(X = Bspline.Basis(Wheat_Bands, Wheat_Wavelengths, nBasis = 23), model = 'BayesA'))
pm4 <- BFR(data = Wheat_GFR, ETA = ETA4, nIter = 1000, burnIn = 300, CrossValidation = CrossV, set_seed = 10, verbose = F)
summary(pm4)

plot(pm4, select = 'MSEP')
boxplot(pm4, select = 'MSEP')
```

```{r cleaner, echo=F, results='hide'}
path <- dir()
files <- path[which(grepl('.dat', path) == TRUE)]
file.remove(files)
```

<h2 id="cite">
  How to cite this package
</h2>

First option, by the article paper

(Comming soon)

Second option, by the manual package
```{r}
citation('IBCF.MTME')
```



<h2 id="contributions">
  Contributions
</h2>

If you have any suggestions or feedback, I would love to hear about it. Feel free to report new issues in [this link](https://github.com/frahik/GFR/issues/new), also if you want to request a feature/report a bug, or make a pull request if you can contribute.


<h2 id="authors">
  Authors
</h2>


 - Francisco Javier Luna-Vázquez (Author, Maintainer)
 - Osval Antonio Montesinos-López (Author)


[LGPL-badge]: https://img.shields.io/badge/License-LGPL%20v3-blue.svg "LGPL, Version 2.0"
[status-bagde]: http://www.repostatus.org/badges/latest/wip.svg "status"
[downloads-badge]: http://cranlogs.r-pkg.org/badges/GFR "GFR cranlogs"
[release-badge]: http://www.r-pkg.org/badges/version-ago/GFR "GFR release"
[cran]: https://cran.r-project.org/package=GFR "CRAN Page"
[LGPL]: https://www.gnu.org/licenses/lgpl-3.0 "LGPL, Version 2.0"
[status]: http://www.repostatus.org/#wip "status - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public"
